<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•™è‚²è¨“ç·´æ»¿æ„åº¦ç³»çµ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body { font-family: 'Inter', 'Noto Sans TC', sans-serif; background-color: #f4f7f9; }
        .rating-input { opacity: 0; position: absolute; width: 1px; height: 1px; }
        .rating-label {
            display: flex; align-items: center; justify-content: center;
            width: 40px; height: 40px; border-radius: 9999px; cursor: pointer;
            transition: all 0.2s; font-weight: 600; color: #4b5563; border: 2px solid #e5e7eb;
        }
        .rating-input:checked + .rating-label {
            background-color: #3b82f6; color: white; border-color: #3b82f6;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .report-table th, .report-table td { padding: 12px 16px; border-bottom: 1px solid #e5e7eb; }
        .chart-bar { height: 10px; border-radius: 4px; transition: width 0.5s; }
    </style>
</head>
<body>
<div id="app" class="min-h-screen p-4 sm:p-8">
    <div class="max-w-4xl mx-auto mb-6 flex justify-between items-center">
        <h1 class="text-3xl font-extrabold text-gray-900">æ•™è‚²è¨“ç·´æ»¿æ„åº¦ç³»çµ±</h1>
        <button id="toggleViewBtn" class="px-4 py-2 bg-indigo-600 text-white rounded-lg shadow-md hover:bg-indigo-700">
            åˆ‡æ›è‡³å ±å‘Šæ¨¡å¼
        </button>
    </div>
    <div id="content" class="max-w-4xl mx-auto bg-white p-6 sm:p-10 rounded-xl shadow-2xl">
        <div class="text-center">è¼‰å…¥ä¸­...</div>
    </div>
    <div id="modal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center z-50">
        <div class="bg-white p-6 rounded-lg shadow-xl max-w-sm w-full">
            <div id="modalMessage" class="text-center text-lg mb-4"></div>
            <button id="modalCloseBtn" class="w-full py-2 bg-indigo-600 text-white rounded-md">ç¢ºå®š</button>
        </div>
    </div>
</div>

<script>
    // ğŸš¨ è«‹ç¢ºèªæ­¤ URL ç‚ºæœ€æ–°éƒ¨ç½²çš„ /exec ç¶²å€
    const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxqMfeDnEI0Dt0yR6t_H9k0-5a41YlSl4biiG1iEPJyT0mQ1Uz1WY1CfkBOUZ7RzfVB/exec';

    const getUserId = () => {
        let id = localStorage.getItem('surveyUserId');
        if (!id) {
            id = 'USER-' + Math.random().toString(36).substring(2, 10).toUpperCase();
            localStorage.setItem('surveyUserId', id);
        }
        return id;
    };

    const userId = getUserId();
    let currentView = 'survey';
    const contentDiv = document.getElementById('content');
    const toggleViewBtn = document.getElementById('toggleViewBtn');

    const questions = {
        'ä¸€ã€è¬›å¸«ä¹‹å‹ä»»ç¨‹åº¦': { 'Q1_1': 'èˆ‡èª²ç¨‹ä¸»é¡Œç›¸é—œä¹‹ä¸»é¡Œèƒ½åŠ›', 'Q1_2': 'å£èªè¡¨é”èƒ½åŠ›', 'Q1_3': 'æ¿€ç™¼å­¸å“¡çš„åƒèˆ‡åŠå­¸ç¿’æ„é¡˜èƒ½åŠ›', 'Q1_4': 'æˆèª²å…§å®¹èˆ‡èª²ç¨‹ä¸»é¡Œä¹‹å¥‘åˆåº¦', 'Q1_5': 'å°æ™‚é–“çš„æŒæ¡èƒ½åŠ›' },
        'äºŒã€èª²ç¨‹å…§å®¹': { 'Q2_1': 'å­¸ç¿’åˆ°è§€å¿µèˆ‡æ–°æŠ€å·§çš„æ»¿æ„åº¦', 'Q2_2': 'è§£æ±ºå·¥ä½œä¸Šæ‰€é¢è‡¨å•é¡Œä¹‹å•Ÿç™¼', 'Q2_3': 'å°é”æˆå·¥ä½œç›®æ¨™çš„åŠ©ç›Š', 'Q2_4': 'æ•™æå…§å®¹çš„æ»¿æ„åº¦', 'Q2_5': 'èª²ç¨‹æ™‚æ•¸å®‰æ’æ»¿æ„åº¦', 'Q2_6': 'æœ¬èª²ç¨‹é”åˆ°æ‚¨é æœŸæ•ˆæœ' },
        'ä¸‰ã€è¾¦è¨“å–®ä½è¡Œæ”¿ä½œæ¥­': { 'Q3_1': 'å°æ–¼
